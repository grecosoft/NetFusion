
{
    "$schema": "http://json.schemastore.org/template",
    "author": "NetFusion-Contrib",
    "classifications": [ "WebApi", "Microservice" ], 
    "name": "Microservice bootstrapped with NetFusion",
    "identity": "netfusion-microservice-template",         
    "groupIdentity":"netfusion.microservice.templates",
    "shortName": "nf.micro-srv",
    "tags": {
      "language": "C#",
      "type":"project"
    },
    "sourceName": "Solution.Context", 
    "preferNameDirectory": true,
    "symbols":{
      "local-cluster-name": {
        "type": "parameter",
        "datatype": "text",
        "replaces": "[nf:local-cluster-name]",
        "isRequired": true,
        "description": "The name of locally created cluster."
      },
      "local-registry-port": {
        "type": "parameter",
        "datatype": "int",
        "replaces": "[nf:local-registry-port]",
        "isRequired": true,
        "description": "The port of the local image registry to which the image is pushed."
      },
      "kube-namespace": {
        "type": "parameter",
        "datatype": "text",
        "replaces": "[nf:kube-namespace]",
        "isRequired": true,
        "description": "The Kubernetes namespace to which the microservice is to be deployed."
      },
      "container-port": {
        "type": "parameter",
        "datatype":"int",
        "replaces": "[nf:container-port]",
        "isRequired": true,
        "description": "The port used when running within a container or locally within a process or IDE."
      },
      "sourceName": {
        "type": "generated",
        "generator": "casing",
        "parameters": {
          "source": "name",
          "toLower": true
        }
      },
      "microservice-name": {
        "type": "generated",
        "generator": "regex",
        "dataType": "string",
        "replaces": "[nf:microservice-name]", 
        "parameters": {
          "source": "sourceName",
          "steps": [
            {
              "regex": "\\.",            
              "replacement": "-"   
            }
          ]
        }
      },
      "app-id": {
        "type": "generated",
        "generator": "guid",
        "replaces": "[nf:app-id]",
        "description": "The generated GUID used to identify the Application Service Plugin Component.",
        "parameters": {
          "format": "D"
        }
      },
      "domain-id": {
        "type": "generated",
        "generator": "guid",
        "replaces": "[nf:domain-id]",
        "description": "The generated GUID used to identify the Domain Plugin Component.",
        "parameters": {
          "format": "D"
        }
      },
      "infra-id": {
        "type": "generated",
        "generator": "guid",
        "replaces": "[nf:infra-id]",
        "description": "The generated GUID used to identify the Infrastructure Plugin Component.",
        "parameters": {
          "format": "D"
        }
      },
      "host-id": {
        "type": "generated",
        "generator": "guid",
        "replaces": "[nf:host-id]",
        "description": "The generated GUID used to identify the Host Plugin Component.",
        "parameters": {
          "format": "D"
        }
      }
    },
    "sources":[
      { "include": ".dockerignore" },
      { "include": "Dockerfile" },
      { "include": "deploy/**/*"},
      { "include": "dev-cluster/**/*"},
      { "include": "src/.vscode/**/*" },
      { "include": "src/Solution.Context.sln" },
      { "include": "src/Components/Solution.Context.Domain/**/*" },
      { "include": "src/Components/Solution.Context.App/**/*" },
      { "include": "src/Components/Solution.Context.Infra/**/*" },
      { "include": "src/Solution.Context.WebApi/**/*" },
      { "include": "src/Solution.Context.Tests/**/*" }
    ],
    "postActions": [{
      "condition": "(OS != \"Windows_NT\")",
      "description": "Make scripts executable",
      "manualInstructions": [{
        "text": "Run 'chmod +x dev-cluster/*.sh'"
      }],
      "actionId": "cb9a6cf3-4f5c-4860-b9d2-03a574959774",
      "args": {
        "+x": "dev-cluster/*.sh"
      },
      "continueOnError": true
    }]
  }
